!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-btn",inactiveButtonClass:"modal__save-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"};function r(e,t,r){const o=t.id+"-error",n=e.querySelector("#"+o);t.classList.remove(r.inputErrorClass),n.textContent="",n.classList.remove(r.errorClass)}function o(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0}function n(e,t,r){!function(e){return e.some((e=>!e.validity.valid))}(e)?function(e,t){e.classList.remove(t.inactiveButtonClass),e.disabled=!1}(t,r):o(t,r)}var a=e+"8650253b58b46f0f1c06.svg",c=e+"d38272e02bb4f1ab1c37.svg",s=e+"40608da7369d39bc1077.svg",l=e+"d73f076c46eb5467f5fc.svg";document.getElementById("header-logo").src=a;const i=document.getElementById("profile-img");document.getElementById("edit-profile-icon").src=c,document.getElementById("new-profile-icon").src=s;const d=document.querySelector(".profile__edit-btn");document.getElementById("edit-avatar-icon").src=l;const u=document.querySelector(".modal__close-btn"),m=document.querySelector(".profile__edit-avatar-btn"),_=document.querySelector("#edit-modal"),v=_.querySelector(".modal__save-btn"),h=_.querySelector("#name"),f=_.querySelector("#description"),y=document.querySelector(".profile__title"),b=document.querySelector(".profile__description"),p=document.querySelector("#card-template"),S=document.querySelector(".cards__list"),E=document.querySelector(".profile__new-btn"),q=document.querySelector("#post-modal"),C=q.querySelector(".modal__close-btn"),L=document.querySelector("#link"),k=document.querySelector("#caption"),g=document.querySelector("#preview-modal"),U=g.querySelector(".modal__img"),x=g.querySelector(".modal__close-btn"),$=g.querySelector(".modal__caption"),I=document.querySelector("#delete-modal"),A=document.forms[2],w=I.querySelector(".modal__delete-btn_cancel"),B=I.querySelector(".modal__close-btn"),T=document.querySelector("#avatar-modal"),j=document.forms[3],P=T.querySelector(".modal__close-btn"),D=T.querySelector("#avatar"),N=(document.querySelector(".profile__overlay"),j.querySelector(".modal__save-btn"));let O,H;const J=q.querySelector(".modal__save-btn"),z=Array.from(document.querySelectorAll(".modal")),F=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.json()))}postNewCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})).catch((e=>(console.error("Failed to post new card:",e),Promise.reject(e))))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.json()))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"3a6ee566-6806-49c1-b2d5-f8c291a34de7","Content-Type":"application/json"}});function M(e){"Escape"==e.key&&z.forEach((e=>{e.classList.contains("modal_opened")&&K(e)}))}function G(e){e.classList.add("modal_opened"),document.addEventListener("keydown",M)}function K(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",M)}function Q(e){setTimeout((()=>{e.textContent="Save"}),2e3)}function R(e){const t=p.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__image"),o=t.querySelector(".card__description"),n=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.src=e.link,r.alt=`${e.name} pic`,o.textContent=e.name,n.addEventListener("click",(()=>{!function(e,t,r){O=e,H=r._id;let o=t;o.classList.contains("card__like-btn_liked")?F.removeLike(H).then(o.classList.remove("card__like-btn_liked")).catch((e=>console.error(e))):F.likeCard(H).then(o.classList.add("card__like-btn_liked")).catch((e=>console.error(e)))}(t,n,e)})),a.addEventListener("click",(()=>function(e,t){O=e,H=t._id,G(I)}(t,e))),r.addEventListener("click",(()=>{U.src=r.src,U.alt=`${o.textContent} pic`,$.textContent=o.textContent,G(g)})),t}var V;F.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{S.append(R(e))})),y.textContent=r.name,b.textContent=r.about,i.src=r.avatar})).catch((e=>{console.error(e)})),x.addEventListener("click",(()=>{K(g)})),z.forEach((e=>{e.addEventListener("click",(t=>{t.target==e&&K(e)}))})),m.addEventListener("click",(()=>{G(T)})),d.addEventListener("click",(()=>{var e,o;G(_),e=_,o=t,[h,f].forEach((t=>{r(e,t,o)})),h.value=y.textContent,f.value=b.textContent})),u.addEventListener("click",(()=>{K(_)})),_.addEventListener("submit",(function(e){e.preventDefault(),v.textContent="Saving...";const t={name:h.value,about:f.value};F.editUserInfo(t).then((e=>{y.textContent=e.name,b.textContent=e.about,K(_),Q(v)})).catch((e=>console.error(e)))})),E.addEventListener("click",(()=>{G(q)})),C.addEventListener("click",(()=>{K(q)})),B.addEventListener("click",(()=>{K(I)})),P.addEventListener("click",(()=>{K(T)})),w.addEventListener("click",(()=>{K(I)})),q.addEventListener("submit",(function(e){e.preventDefault(),J.textContent="Saving...",F.postNewCard(k.value,L.value).then((r=>{const n=R(r);S.prepend(n),e.target.reset(),o(J,t),K(q),Q(J)})).catch((e=>{console.log("Error creating card:",e)}))})),A.addEventListener("submit",(function(e){e.preventDefault(),F.removeCard(H).then((()=>{O.remove(),K(I)})).catch((e=>console.error(e)))})),j.addEventListener("submit",(function(e){e.preventDefault(),N.textContent="Saving...",F.editUserAvatar(D.value).then((e=>{i.src=e.avatar,K(T),Q(N),D.value=""})).catch((e=>console.error(e)))})),V=t,Array.from(document.querySelectorAll(V.formSelector)).forEach((e=>{!function(e,t){const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((c=>{c.addEventListener("input",(()=>{!function(e,t,o){t.validity.valid?r(e,t,o):function(e,t,r,o){const n=t.id+"-error",a=e.querySelector("#"+n);t.classList.add(o.inputErrorClass),a.textContent=r,a.classList.add(o.errorClass)}(e,t,t.validationMessage,o)}(e,c,t),n(o,a,t)}))}))}(e,V)})),console.log("avatar form:",j,"avatar submit btn:",N)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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akJpRSxFQUFhN0QsR0FDYkQsRUFBWXFGLE1BQVEsRUFBRSxJQUV2QjdDLE9BQU9DLEdBQVFDLFFBQVFDLE1BQU1GLElBQ2xDLElEdkkwQmhHLEVDbVFUVixFRGxRR3VFLE1BQU1DLEtBQUszQyxTQUFTNEMsaUJBQWlCL0QsRUFBT1QsZUFFcER1SCxTQUFTaEgsS0FsQnJCLFNBQTJCQSxFQUFhRSxHQUN0QyxNQUFNYSxFQUFZZ0QsTUFBTUMsS0FDdEJoRSxFQUFZaUUsaUJBQWlCL0QsRUFBT1IsZ0JBRWhDaUIsRUFBZ0JYLEVBQVlNLGNBQWNKLEVBQU9QLHNCQUV2RG1CLEVBQWtCQyxFQUFXSixFQUFlVCxHQUM1Q2EsRUFBVWlHLFNBQVMvRyxJQUNqQkEsRUFBYW9ILGlCQUFpQixTQUFTLE1BbkQzQyxTQUE0QnJILEVBQWFDLEVBQWNDLEdBQ2hERCxFQUFhZ0IsU0FBU0MsTUFRekJuQixFQUFlQyxFQUFhQyxFQUFjQyxHQXpCOUMsU0FBd0JGLEVBQWFDLEVBQWNtSixFQUFjbEosR0FDL0QsTUFBTUMsRUFBaUJGLEVBQWFHLEdBQUssU0FDbkNDLEVBQWVMLEVBQVlNLGNBQWMsSUFBTUgsR0FDckRGLEVBQWFNLFVBQVVLLElBQUlWLEVBQU9MLGlCQUNsQ1EsRUFBYUksWUFBYzJJLEVBQzNCL0ksRUFBYUUsVUFBVUssSUFBSVYsRUFBT0osV0FDcEMsQ0FZSXVKLENBQ0VySixFQUNBQyxFQUNBQSxFQUFhcUosa0JBQ2JwSixFQUtOLENBeUNNcUosQ0FBbUJ2SixFQUFhQyxFQUFjQyxHQUM5Q1ksRUFBa0JDLEVBQVdKLEVBQWVULEVBQU8sR0FDbkQsR0FFTixDQU1Jc0osQ0FBa0J4SixFQUFhRSxFQUFPLElDaVExQ2lHLFFBQVFnRCxJQUNOLGVBQ0E1RixFQUNBLHFCQUNBRyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3BvdHMtcHJvamVjdC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zcG90cy1wcm9qZWN0L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3Nwb3RzLXByb2plY3QvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3Nwb3RzLXByb2plY3QvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc3BvdHMtcHJvamVjdC8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idG5cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZS1idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX3Zpc2libGVcIixcbn07XG5cbmZ1bmN0aW9uIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudElkID0gaW5wdXRFbGVtZW50LmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yRWxlbWVudElkKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xufVxuXG5mdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpIHtcbiAgY29uc3QgZXJyb3JFbGVtZW50SWQgPSBpbnB1dEVsZW1lbnQuaWQgKyBcIi1lcnJvclwiO1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JFbGVtZW50SWQpO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xufVxuXG5mdW5jdGlvbiBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBlbmFibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKSB7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpIHtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG59XG5cbmZ1bmN0aW9uIHJlc2V0VmFsaWRhdGlvbihmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpIHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgZW5hYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZykge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oY29uZmlnKSB7XG4gIGNvbnN0IGZvcm1zTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgZm9ybXNMaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xufVxuXG5leHBvcnQgeyByZXNldFZhbGlkYXRpb24sIGRpc2FibGVCdXR0b24sIGVuYWJsZVZhbGlkYXRpb24sIHNldHRpbmdzIH07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHtcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBkaXNhYmxlQnV0dG9uLFxuICBlbmFibGVWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQgaGVhZGVyU3JjIGZyb20gXCIuLi9pbWFnZXMvaGVhZGVyX2xvZ28uc3ZnXCI7XG5pbXBvcnQgZWRpdFByb2ZpbGVTcmMgZnJvbSBcIi4uL2ltYWdlcy9lZGl0LXByb2ZpbGUtaWNvbi5zdmdcIjtcbmltcG9ydCBuZXdQcm9maWxlU3JjIGZyb20gXCIuLi9pbWFnZXMvYWRkLWljb24uc3ZnXCI7XG5pbXBvcnQgZWRpdEF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL0dyb3VwMi5zdmdcIjtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyLWxvZ29cIik7XG5oZWFkZXJMb2dvLnNyYyA9IGhlYWRlclNyYztcbmNvbnN0IHByb2ZpbGVJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtaW1nXCIpO1xuY29uc3QgZWRpdEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtcHJvZmlsZS1pY29uXCIpO1xuZWRpdEljb24uc3JjID0gZWRpdFByb2ZpbGVTcmM7XG5jb25zdCBuZXdJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctcHJvZmlsZS1pY29uXCIpO1xubmV3SWNvbi5zcmMgPSBuZXdQcm9maWxlU3JjO1xuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBlZGl0QXZhdGFySWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1hdmF0YXItaWNvblwiKTtcbmVkaXRBdmF0YXJJY29uLnNyYyA9IGVkaXRBdmF0YXJTcmM7XG5jb25zdCBjbG9zZVByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbmNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYXZhdGFyLWJ0blwiKTtcblxuY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuXG5jb25zdCBwcm9maWxlU3VibWl0QnV0dG9uID1cbiAgcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnRuXCIpO1xuXG5jb25zdCBuYW1lSW5wdXQgPSBwcm9maWxlRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNuYW1lXCIpO1xuXG5jb25zdCBqb2JJbnB1dCA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2Rlc2NyaXB0aW9uXCIpO1xuXG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuXG5jb25zdCBwcm9maWxlSm9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcblxuY29uc3QgY2FyZHNMaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbmNvbnN0IG5ld1Byb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1idG5cIik7XG5cbmNvbnN0IG5ld1Bvc3RGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1tb2RhbFwiKTtcblxuY29uc3QgY2xvc2VQb3N0QnV0dG9uID0gbmV3UG9zdEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcblxuY29uc3QgbGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsaW5rXCIpO1xuXG5jb25zdCBjYXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XG5cbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcblxuY29uc3QgcHJldmlld0ltYWdlRWxlbWVudCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWdcIik7XG5cbmNvbnN0IHByZXZpZXdDbG9zZUJ1dHRvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5cbmNvbnN0IGRlbGV0ZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1syXTtcblxuY29uc3QgY2FuY2VsQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVsZXRlLWJ0bl9jYW5jZWxcIik7XG5cbmNvbnN0IGNsb3NlRGVsZXRlYnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuXG5jb25zdCBhdmF0YXJGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zWzNdO1xuXG5jb25zdCBjbG9zZUF2YXRhckJ1dHRvbiA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcblxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhclwiKTtcblxuY29uc3QgYXZhdGFyT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fb3ZlcmxheVwiKTtcblxuY29uc3QgYXZhdGFyU3VibWl0QnV0dG9uID0gYXZhdGFyRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idG5cIik7XG5cbmxldCBzZWxlY3RlZENhcmQ7XG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XG5cbmNvbnN0IG5ld1Bvc3RTdWJtaXRCdXR0b24gPVxuICBuZXdQb3N0Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idG5cIik7XG5cbmNvbnN0IG1vZGFsc0xpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIikpO1xuXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIEJyaWRnZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiRHViYWlcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzMyNTMwMzY1Nzc5LWRiZjViZGY0YmM2Mz9xPTgwJnc9MjE2MCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVG9reW9cIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcGx1cy51bnNwbGFzaC5jb20vcHJlbWl1bV9waG90by0xNjYxOTE0MjQwOTUwLWIwMTI0ZjIwYTVjMT9xPTgwJnc9MjY3MCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiUm9tZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wbHVzLnVuc3BsYXNoLmNvbS9wcmVtaXVtX3Bob3RvLTE2NzU5NzU3MDY1MTMtOWRhYmEwZWMxMmE4P3E9ODAmdz0yNjcwJmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJSaW8gZGUgSmFuZWlyb1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wbHVzLnVuc3BsYXNoLmNvbS9wcmVtaXVtX3Bob3RvLTE2NzEyMTEzMDc5OTctZjRmNTUyYjA2MDFjP3E9ODAmdz0yNjcwJmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJQYXJpc1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wbHVzLnVuc3BsYXNoLmNvbS9wcmVtaXVtX3Bob3RvLTE2NjE5MTkyMTAwNDMtZmQ4NDdhNTg1MjJkP3E9ODAmdz0yNjcxJmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxuLy8gICB9LFxuLy8gXTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiM2E2ZWU1NjYtNjgwNi00OWMxLWIyZDUtZjhjMjkxYTM0ZGU3XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkcywgdXNlcl0pID0+IHtcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICBjYXJkc0xpc3RFbGVtZW50LmFwcGVuZChnZXRDYXJkRWxlbWVudERhdGEoY2FyZCkpO1xuICAgIH0pO1xuICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICBwcm9maWxlSm9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gICAgcHJvZmlsZUltZy5zcmMgPSB1c2VyLmF2YXRhcjtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcbiAgfSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT0gXCJFc2NhcGVcIikge1xuICAgIG1vZGFsc0xpc3QuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgICAgIGlmIChtb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgaGFuZGxlQ2xvc2VNb2RhbChtb2RhbCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZW5hYmxlRXNjKCkge1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xufVxuXG5mdW5jdGlvbiBkaXNhYmxlRXNjKCkge1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgZW5hYmxlRXNjKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZGlzYWJsZUVzYygpO1xufVxuXG5mdW5jdGlvbiByZXR1cm5Ub1NhdmUoYnV0dG9uKSB7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICB9LCAyMDAwKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBwcm9maWxlU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgY29uc3QgcGF0Y2ggPSB7IG5hbWU6IG5hbWVJbnB1dC52YWx1ZSwgYWJvdXQ6IGpvYklucHV0LnZhbHVlIH07XG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8ocGF0Y2gpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgIHByb2ZpbGVKb2JFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICAgIGhhbmRsZUNsb3NlTW9kYWwocHJvZmlsZUZvcm1FbGVtZW50KTtcbiAgICAgIHJldHVyblRvU2F2ZShwcm9maWxlU3VibWl0QnV0dG9uKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVOZXdQb3N0U3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgbmV3UG9zdFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGFwaVxuICAgIC5wb3N0TmV3Q2FyZChjYXB0aW9uSW5wdXQudmFsdWUsIGxpbmtJbnB1dC52YWx1ZSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50RGF0YShyZXMpO1xuICAgICAgY2FyZHNMaXN0RWxlbWVudC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgICAgIGRpc2FibGVCdXR0b24obmV3UG9zdFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgICAgaGFuZGxlQ2xvc2VNb2RhbChuZXdQb3N0Rm9ybUVsZW1lbnQpO1xuICAgICAgcmV0dXJuVG9TYXZlKG5ld1Bvc3RTdWJtaXRCdXR0b24pO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgY3JlYXRpbmcgY2FyZDpcIiwgZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYXZhdGFyU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgYXBpXG4gICAgLmVkaXRVc2VyQXZhdGFyKGF2YXRhcklucHV0LnZhbHVlKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlSW1nLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgaGFuZGxlQ2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgICByZXR1cm5Ub1NhdmUoYXZhdGFyU3VibWl0QnV0dG9uKTtcbiAgICAgIGF2YXRhcklucHV0LnZhbHVlID0gXCJcIjtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBhcGlcbiAgICAucmVtb3ZlQ2FyZChzZWxlY3RlZENhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XG4gICAgICBoYW5kbGVDbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKSB7XG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xuICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xuICBoYW5kbGVPcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZEVsZW1lbnQsIGJ0bkVsZW1lbnQsIGRhdGEpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gIGxldCBzZWxlY3RlZEJ0biA9IGJ0bkVsZW1lbnQ7XG5cbiAgaWYgKCFzZWxlY3RlZEJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgICAgLnRoZW4oc2VsZWN0ZWRCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpKVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAucmVtb3ZlTGlrZShzZWxlY3RlZENhcmRJZClcbiAgICAgIC50aGVuKHNlbGVjdGVkQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50RGF0YShkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmRUaXRsZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG5cbiAgY2FyZEltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gYCR7ZGF0YS5uYW1lfSBwaWNgO1xuICBjYXJkVGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkTGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGhhbmRsZUxpa2VDbGljayhjYXJkRWxlbWVudCwgY2FyZExpa2VCdXR0b24sIGRhdGEpO1xuICB9KTtcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKVxuICApO1xuICBjYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlRWxlbWVudC5zcmMgPSBjYXJkSW1hZ2VFbGVtZW50LnNyYztcbiAgICBwcmV2aWV3SW1hZ2VFbGVtZW50LmFsdCA9IGAke2NhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnR9IHBpY2A7XG4gICAgcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkVGl0bGVFbGVtZW50LnRleHRDb250ZW50O1xuICAgIGhhbmRsZU9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIHNldE1vZGFsQ2xvc2VMaXN0ZW5lcnMoKSB7XG4gIG1vZGFsc0xpc3QuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQgPT0gbW9kYWwpIHtcbiAgICAgICAgaGFuZGxlQ2xvc2VNb2RhbChtb2RhbCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5wcmV2aWV3Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaGFuZGxlQ2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xufSk7XG5cbnNldE1vZGFsQ2xvc2VMaXN0ZW5lcnMoKTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBoYW5kbGVPcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xufSk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaGFuZGxlT3Blbk1vZGFsKHByb2ZpbGVGb3JtRWxlbWVudCk7XG4gIHJlc2V0VmFsaWRhdGlvbihwcm9maWxlRm9ybUVsZW1lbnQsIFtuYW1lSW5wdXQsIGpvYklucHV0XSwgc2V0dGluZ3MpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIGpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYkVsZW1lbnQudGV4dENvbnRlbnQ7XG59KTtcblxuY2xvc2VQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGhhbmRsZUNsb3NlTW9kYWwocHJvZmlsZUZvcm1FbGVtZW50KTtcbn0pO1xuXG5wcm9maWxlRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5cbm5ld1Byb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaGFuZGxlT3Blbk1vZGFsKG5ld1Bvc3RGb3JtRWxlbWVudCk7XG59KTtcblxuY2xvc2VQb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGhhbmRsZUNsb3NlTW9kYWwobmV3UG9zdEZvcm1FbGVtZW50KTtcbn0pO1xuXG5jbG9zZURlbGV0ZWJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBoYW5kbGVDbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbn0pO1xuXG5jbG9zZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBoYW5kbGVDbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5jYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaGFuZGxlQ2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG59KTtcblxubmV3UG9zdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlTmV3UG9zdFN1Ym1pdCk7XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5hdmF0YXJGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuXG5jb25zb2xlLmxvZyhcbiAgXCJhdmF0YXIgZm9ybTpcIixcbiAgYXZhdGFyRm9ybUVsZW1lbnQsXG4gIFwiYXZhdGFyIHN1Ym1pdCBidG46XCIsXG4gIGF2YXRhclN1Ym1pdEJ1dHRvblxuKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pLnRoZW4oXG4gICAgICAocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pLnRoZW4oXG4gICAgICAocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH0pO1xuICB9XG5cbiAgcG9zdE5ld0NhcmQobmFtZSwgbGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcG9zdCBuZXcgY2FyZDpcIiwgZXJyKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBlZGl0VXNlckF2YXRhcih1cmwpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IHVybCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJlcnJvckVsZW1lbnRJZCIsImlkIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiZGlzYWJsZUJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJhZGQiLCJkaXNhYmxlZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJlbmFibGVCdXR0b24iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwiaGVhZGVyU3JjIiwicHJvZmlsZUltZyIsImVkaXRQcm9maWxlU3JjIiwibmV3UHJvZmlsZVNyYyIsImVkaXRCdXR0b24iLCJlZGl0QXZhdGFyU3JjIiwiY2xvc2VQcm9maWxlQnV0dG9uIiwiZWRpdEF2YXRhckJ1dHRvbiIsInByb2ZpbGVGb3JtRWxlbWVudCIsInByb2ZpbGVTdWJtaXRCdXR0b24iLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsInByb2ZpbGVOYW1lRWxlbWVudCIsInByb2ZpbGVKb2JFbGVtZW50IiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0RWxlbWVudCIsIm5ld1Byb2ZpbGVCdXR0b24iLCJuZXdQb3N0Rm9ybUVsZW1lbnQiLCJjbG9zZVBvc3RCdXR0b24iLCJsaW5rSW5wdXQiLCJjYXB0aW9uSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3SW1hZ2VFbGVtZW50IiwicHJldmlld0Nsb3NlQnV0dG9uIiwicHJldmlld0NhcHRpb24iLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJmb3JtcyIsImNhbmNlbEJ1dHRvbiIsImNsb3NlRGVsZXRlYnV0dG9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtRWxlbWVudCIsImNsb3NlQXZhdGFyQnV0dG9uIiwiYXZhdGFySW5wdXQiLCJhdmF0YXJTdWJtaXRCdXR0b24iLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsIm5ld1Bvc3RTdWJtaXRCdXR0b24iLCJtb2RhbHNMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInBvc3ROZXdDYXJkIiwibGluayIsIkVycm9yIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJyZW1vdmVMaWtlIiwiZWRpdFVzZXJBdmF0YXIiLCJ1cmwiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiaGFuZGxlRXNjYXBlIiwiZXZ0Iiwia2V5IiwiZm9yRWFjaCIsIm1vZGFsIiwiY29udGFpbnMiLCJoYW5kbGVDbG9zZU1vZGFsIiwiaGFuZGxlT3Blbk1vZGFsIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZXR1cm5Ub1NhdmUiLCJidXR0b24iLCJzZXRUaW1lb3V0IiwiZ2V0Q2FyZEVsZW1lbnREYXRhIiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsZW1lbnQiLCJjYXJkVGl0bGVFbGVtZW50IiwiY2FyZExpa2VCdXR0b24iLCJjYXJkRGVsZXRlQnV0dG9uIiwiYWx0IiwiYnRuRWxlbWVudCIsIl9pZCIsInNlbGVjdGVkQnRuIiwiaGFuZGxlTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRzIiwidXNlciIsImNhcmQiLCJhcHBlbmQiLCJ0YXJnZXQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicGF0Y2giLCJwcmVwZW5kIiwicmVzZXQiLCJsb2ciLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9